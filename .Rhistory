library(tidyverse)
# library(rvest)
# library(albersusa)
library(sf)
library(leaflet)
library(leafpop)
library(formattable)
library(ggiraph)
library(urbnmapr) # change to include AK/HI on map
library(cowplot)
library(RcppRoll)
library(htmlTable)
library(ggtext)
library(patchwork)
library(Hmisc)
library(httr)
library(rvest)
# Default ggplot theme
theme_set(theme_bw() +
theme(axis.title.x = element_text(size = rel(1.25)),
axis.title.y = element_text(size = rel(1.25)),
plot.caption = element_text(face = "italic", size = 9),
legend.position = "bottom",
legend.background = element_rect(fill = "transparent"),
panel.background = element_rect(fill = "transparent"),
panel.border = element_blank(),
axis.line = element_line(color="black"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_blank(),
panel.grid.major.y = element_line(color = "grey90", linetype = 2)
))
# file downloads and processes all data
# CHECKS THE AGE FILE (SMALLEST) FOR UPDATE-
{  filename <- here::here("data_tndoh/Public-Dataset-Age.xlsx")
oldchecksum <- tools::md5sum(filename)
download.file(url = #"https://www.tn.gov/content/dam/tn/health/documents/cedep/novel-coronavirus/datasets/Public-Dataset-Age.xlsx",
# "https://www.tn.gov/content/dam/tn/health/documents/cedep/novel-coronavirus/datasets/Public-Dataset-Age.XLSX",
"https://www.tn.gov/content/dam/tn/health/documents/cedep/novel-coronavirus/datasets/Public-Dataset-Age.XLSX",
mode = 'wb',
destfile = here::here("data_tndoh/Public-Dataset-Age.xlsx"))
newchecksum <- tools::md5sum(filename)
ifelse(oldchecksum == newchecksum,
"TNDOH data is Unchanged since last download",
source(here::here("code/Download all data.R")))
}
## FORCE UPDATE:
# source(here::here("code/Download all data.R"))
library(tidyverse)
# library(rvest)
# library(albersusa)
library(sf)
library(leaflet)
library(leafpop)
library(formattable)
library(ggiraph)
library(urbnmapr) # change to include AK/HI on map
library(cowplot)
library(RcppRoll)
library(htmlTable)
library(ggtext)
library(patchwork)
library(Hmisc)
library(httr)
library(rvest)
# Default ggplot theme
theme_set(theme_bw() +
theme(axis.title.x = element_text(size = rel(1.25)),
axis.title.y = element_text(size = rel(1.25)),
plot.caption = element_text(face = "italic", size = 9),
legend.position = "bottom",
legend.background = element_rect(fill = "transparent"),
panel.background = element_rect(fill = "transparent"),
panel.border = element_blank(),
axis.line = element_line(color="black"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_blank(),
panel.grid.major.y = element_line(color = "grey90", linetype = 2)
))
## FORCE UPDATE:
source(here::here("code/Download all data.R"))
